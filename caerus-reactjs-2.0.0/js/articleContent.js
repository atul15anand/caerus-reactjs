!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t){var n=document.getElementById("navAccountDropdownDesktop")||document.getElementById("MarketNav"),r=document.createElement("div");r.innerHTML=e,r.style.color=t,r.style.fontSize="20px",r.style.fontWeight="700",r.style.position="absolute",r.style.right="350px",r.style.zIndex="100",n.parentNode.insertBefore(r,n)}function n(e,t){if(console.log("data is : ",t),null==t)return null;switch(e){case"innerHTML":return t.innerHTML;case"innerText":return t.innerText;case"content":return t.content;case"src":return t.src}}function r(e){switch(e.query_selector){case"getElementsByClassName":for(var t=[],r=(document.getElementsByClassName(e.query_value),0);r<e.token_number.length;r++)t.push(a[e.token_number[r]]);return t.join(" ");case"getElementsByTagName":var o=[],a=document.getElementsByTagName(e.query_value);console.log("item in tags value : ",a);for(var l=0;l<e.token_number.length;l++){console.log(a[e.token_number[l]]);var s=n(e.html_attribute,a[e.token_number[l]].link_data);console.log("value is : ",s),s&&o.push(n(e.html_attribute,a[e.token_number[l]].link_data))}return o.join(" ");case"getElementById":return document.getElementById(e.query_value);case"querySelector":return n(e.html_attribute,document.querySelector(e.query_value));case"querySelectorAll":return n(e.html_attribute,document.querySelectorAll(e.query_value))}}chrome.runtime.onMessage.addListener((function(n,r,o){if(!n.url!==window.location.href){if("storeRssSourceNotFound"===n.action){var a=localStorage.getItem("rss_sources_url")?JSON.parse(localStorage.getItem("rss_sources_url")):[],l=n.data;return a.includes(l)||(a.push(l),localStorage.setItem("rss_sources_url",JSON.stringify(a))),t("Rss Source not found.Add "+l,"red"),"Returned"}if("storeConfirmedUrl"===n.action){var s=JSON.parse(localStorage.getItem("articleLinksData"))||[],c=n.url.replace("?flagToClose=true","");if(!s.includes(c)){var i=[].concat(function(t){if(Array.isArray(t))return e(t)}(u=s)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(u)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[c]);localStorage.setItem("articleLinksData",JSON.stringify(i))}n.message&&t("Synced Successfully","green"),o({success:!0})}else"dataMissingMessage"===n.action?t(Object.keys(n.data).filter((function(e){return""===n.data[e]||null==n.data[e]}))+" missing, request cannot be processed","red"):"cookieMissingError"===n.action?t("You need to login in https://news.almaconnect.com.","red"):"duplicateData"==n.action&&(t("News article already processed","red"),o({success:!0}))}var u})),window.onload=function(){var e=null;chrome.runtime.sendMessage({action:"requestForRssSource"},(function(t){if(console.log("Message sent to background script"),t&&t.data){console.log("response is : ",t),e=t.data,console.log(e);var n,o=r(e.published_at);console.log("dateContent : ",o);var a=window.location.href,l=window.location.href.replace("?flatToClose=true","");console.log("tab url is : ",l);for(var s=null,c=0;c<e.title.length;c++){console.log(e.title[c]);var i=r(e.title[c]);console.log("title line is : ",i),s||(s=i)}console.log("title is : ",s);for(var u=null,m=0;m<e.article_content.length;m++){var d=r(e.article_content[m]);if("all"==e.article_content[m].html_attribute)for(var g=0;g<d.length;g++)u+=d[g]}if(a.includes("/inno/")){for(var f=document.getElementsByClassName("article-content-item--paragraph"),y=null,v=0;v<f.length;v++)y+=f[0];u=y;var h=document.getElementsByTagName("img")[0];n=h?h.src:null}else{var p=document.getElementsByClassName("content")[0],_=document.getElementsByClassName("content")[2];u=(p?p.innerText:"")+(_?_.innerText:"");var b=document.querySelector('meta[property="og:image:secure_url"]');n=b?b.content:null}var S={content:{article_url:l,article_content:u,image_url:n,source:"bizjournals.com",published_at:o,title:void 0}};chrome.runtime.sendMessage({action:"sendInfoFromArticle",data:S,url:window.location.href})}}))}}();