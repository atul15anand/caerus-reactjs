!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function t(e,t){var n=document.getElementById("navAccountDropdownDesktop")||document.getElementById("MarketNav"),o=document.createElement("div");o.innerHTML=e,o.style.color=t,o.style.fontSize="20px",o.style.fontWeight="700",o.style.position="absolute",o.style.right="350px",o.style.zIndex="100",n.parentNode.insertBefore(o,n)}function n(e,t){if(console.log("data is : ",t),null==t)return null;switch(e){case"innerHTML":return t.innerHTML;case"innerText":return t.innerText;case"content":return t.content;case"src":return t.src}}function o(e){switch(e.query_selector){case"getElementsByClassName":var t=[],o=document.getElementsByClassName(e.query_value);console.log("temp is : ",o);var r=e.token_number;if(console.log("index list is : ",r),console.log("condition is : ",r.length>0&&-1==r[0]),r.length>0&&-1==r[0])for(var l=0;l<o.length;l++){var a=n(e.html_attribute,o[l]);a&&t.push(a)}else if(r.length>0)for(var s=0;s<e.token_number.length;s++){var c=n(e.html_attribute,o[e.token_number[s]]);console.log("value is : ",c),c&&t.push(c)}return t.join(" ");case"getElementsByTagName":var i=[],u=document.getElementsByTagName(e.query_value);console.log("item in tags value : ",u);for(var g=0;g<e.token_number.length;g++){console.log(u[e.token_number[g]]);var d=n(e.html_attribute,u[e.token_number[g]].link_data);console.log("value is : ",d),d&&i.push(d)}return i.join(" ");case"getElementById":return document.getElementById(e.query_value);case"querySelector":return n(e.html_attribute,document.querySelector(e.query_value));case"querySelectorAll":return n(e.html_attribute,document.querySelectorAll(e.query_value))}}chrome.runtime.onMessage.addListener((function(n,o,r){if(!n.url!==window.location.href){if("storeRssSourceNotFound"===n.action){var l=localStorage.getItem("rss_sources_url")?JSON.parse(localStorage.getItem("rss_sources_url")):[],a=n.data;return l.includes(a)||(l.push(a),localStorage.setItem("rss_sources_url",JSON.stringify(l))),t("Rss Source not found.Add "+a,"red"),"Returned"}if("storeConfirmedUrl"===n.action){var s=JSON.parse(localStorage.getItem("articleLinksData"))||[],c=n.url.replace("?flagToClose=true","");if(!s.includes(c)){var i=[].concat(function(t){if(Array.isArray(t))return e(t)}(u=s)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(u)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,n):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[c]);localStorage.setItem("articleLinksData",JSON.stringify(i))}n.message&&t("Synced Successfully","green"),r({success:!0})}else"dataMissingMessage"===n.action?t(Object.keys(n.data).filter((function(e){return""===n.data[e]||null==n.data[e]}))+" missing, request cannot be processed","red"):"cookieMissingError"===n.action?t("You need to login in https://news.almaconnect.com.","red"):"duplicateData"==n.action&&(t("News article already processed","red"),r({success:!0}))}var u})),window.onload=function(){var e=null;chrome.runtime.sendMessage({action:"requestForRssSource"},(function(t){if(console.log("Message sent to background script"),t&&t.data){console.log("response is : ",t),e=t.data,console.log(e),console.log("DATE");var n,r=o(e.published_at);console.log("dateContent : ",r);var l=window.location.href,a=l.replace("?flatToClose=true","");console.log("TITLE");for(var s=null,c=0;c<e.title.length;c++){var i=o(e.title[c]);s||(s=i)}console.log("title is : ",s),console.log("ARTICLE CONTENT");for(var u=null,g=0;g<e.article_content.length;g++)console.log("current query for article content : ",e.article_content[g]),u||(u=o(e.article_content[g])),console.log("article content is: ",u);console.log("final article content is : ",u),console.log("IMAGE URL");for(var d=0;d<e.image_url.length;d++)n||(n=o(e.image_url[d])),console.log("current image url is : ",n);console.log("image url is : ",n);var m={article_url:a,article_content:u,image_url:n,source:"bizjournals.com",published_at:r,title:s,link:l};console.log("CONTENT IS :",m);var f={content:m};chrome.runtime.sendMessage({action:"sendInfoFromArticle",data:f,url:window.location.href})}}))}}();